---
import { getEntry } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import CompactHeader from '../../components/compact-header/CompactHeader.astro';

const { slug } = Astro.params;

if (!slug) {
  return Astro.redirect('/404');
}

const post = await getEntry('blog', slug);

if (!post) {
  return Astro.redirect('/404');
}

const { Content } = await post.render();
---

<Layout title={`${post.data.title} | Manuel Tumiati's Blog`} description={post.data.description}>
  <main class="bg-gray-50 dark:bg-gray-950 min-h-screen flex flex-col items-center transition-colors duration-300">
    <div class="w-full max-w-5xl px-6 lg:px-8 py-8 lg:py-16">
      <CompactHeader showBlogLink={true} />
      
      <section class="w-full">
        <article class="bg-white dark:bg-gray-900 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-800 p-8 md:p-12 transition-all duration-300">
          <header class="mb-10 border-b border-gray-100 dark:border-gray-800 pb-10">
            <nav class="mb-6">
              <a
                href="/blog"
                class="text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-300 font-semibold transition-colors inline-flex items-center gap-2 text-sm"
              >
                &larr; Back to Blog
              </a>
            </nav>
            <h1 class="text-3xl md:text-5xl font-extrabold text-gray-900 dark:text-white mb-6 tracking-tight leading-tight">
              {post.data.title}
            </h1>
            <div class="flex items-center text-sm font-medium text-gray-500 dark:text-gray-400">
              <time datetime={post.data.date.toISOString()}>
                {post.data.date.toLocaleDateString("en-US", {
                  year: "numeric",
                  month: "long",
                  day: "numeric",
                })}
              </time>
            </div>
          </header>

          <div
            class="prose prose-lg dark:prose-invert max-w-none 
              prose-headings:font-bold prose-headings:text-gray-900 dark:prose-headings:text-white 
              prose-p:text-gray-600 dark:prose-p:text-gray-300 prose-p:leading-relaxed
              prose-a:text-purple-600 dark:prose-a:text-purple-400 prose-a:no-underline hover:prose-a:underline 
              prose-strong:text-gray-900 dark:prose-strong:text-white 
              prose-code:text-purple-600 dark:prose-code:text-purple-400 prose-code:bg-purple-50 dark:prose-code:bg-purple-900/20 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded-md prose-code:before:content-none prose-code:after:content-none
              prose-pre:bg-gray-900 dark:prose-pre:bg-gray-800 prose-pre:text-gray-100 prose-pre:rounded-xl prose-pre:shadow-lg
              prose-img:rounded-xl prose-img:shadow-md"
          >
            <Content />
          </div>
        </article>
      </section>
    </div>
  </main>
</Layout>
